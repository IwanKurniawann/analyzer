# Nama workflow yang akan ditampilkan di tab Actions GitHub
name: Crypto Trading Signal Analyzer

# Pemicu (trigger) untuk workflow ini
on:
  # Menjalankan workflow secara otomatis setiap 4 jam
  schedule:
    - cron: '0 */4 * * *' # Menjalankan pada menit ke-0 setiap 4 jam
  
  # Memungkinkan untuk menjalankan workflow ini secara manual dari tab Actions
  workflow_dispatch:

# Mendefinisikan satu atau lebih pekerjaan (jobs) yang akan dijalankan
jobs:
  run-analyzer:
    # Menggunakan runner terbaru yang disediakan oleh GitHub (biasanya Ubuntu)
    runs-on: ubuntu-latest

    # Langkah-langkah yang akan dieksekusi dalam pekerjaan ini
    steps:
      # Langkah 1: Checkout kode dari repositori
      # Ini akan mengunduh kode Anda ke runner
      - name: Checkout repository
        uses: actions/checkout@v3

      # Langkah 2: Menyiapkan environment Python
      # Menginstal versi Python yang diinginkan
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10' # Anda bisa menggunakan versi Python lain jika diperlukan

      # Langkah 3: Menginstal dependensi
      # Membaca file requirements.txt dan menginstal semua library yang diperlukan
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      # Langkah 4: Menjalankan skrip analisiss
      # Menjalankan file main.py. Kredensial Telegram disuntikkan sebagai environment variables
      # menggunakan secrets yang telah Anda atur di pengaturan repositori.
      - name: Run Python Analyzer Script
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: python main.py
